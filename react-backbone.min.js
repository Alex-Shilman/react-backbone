/*!
 * react-backbone v0.1.0;  MIT license
 */
!function(t){"function"==typeof define&&define.amd?define(["react","backbone"],function(n,e){t(n,e)}):t(React,Backbone)}(function(t,n,e){function i(t,n,e,i){if(i=i||this,this.__modelEvents||(this.__modelEvents={}),this.__modelEvents[n]={type:t,callback:e,context:i},this.isMounted()){var o=this.getModel();o&&o[t](n,e,i)}}t.mixins.add("modelAccessor",{getModel:function(){return this.model||this.props.model},setModel:function(t){this._modelUnbindAll&&this._modelUnbindAll(!0),this.model=t,this._modelBindAll&&this.isMounted()&&this._modelBindAll()}}),t.mixins.add("modelEventBinder",{modelOn:function(t,n,e){i.call(this,"on",t,n,e)},modelOnce:function(t,n,e){i.call(this,"once",t,n,e)},modelOff:function(t,n,e){if(this.__modelEvents){var i=this.__modelEvents[t],o=this.getModel();o&&i?o.off(t,n,e||this):i&&delete this.__modelEvents[t]}},_modelBindAll:function(){if(this.__modelEvents){var t=this.getModel();t&&e.each(this.__modelEvents,function(n,e){t[n.type](e,n.callback,n.context)})}},_modelUnbindAll:function(t){if(this.__modelEvents){var n=this.getModel();n&&e.each(this.__modelEvents,function(t,e){n.off(e,t.callback,t.context)}),t||delete this.__modelEvents}},componentDidMount:function(){this._modelUnbindAll(!0),this._modelBindAll(!0)},componentWillUnmount:function(){this._modelUnbindAll(!0)}},"modelAccessor"),t.mixins.add("modelChangeListener",{getInitialState:function(){return e.each(["change","reset","add","remove","sort"],function(t){this.modelOn(t,function(){this.forceUpdate()})},this),null}},"modelEventBinder"),t.mixins.add("loadOn",{getInitialState:function(){var t=this.props.loadOn;return this.modelOn("async:"+t,function(t){this.setState({loading:!0}),t.on("complete",function(){this.setState({loading:!1})},this)}),{}}},"modelEventBinder"),t.mixins.add("asyncListener",{getInitialState:function(){this.modelOn("async",function(t,n){this.setState({loading:!0});var e=this.getModel();n.on("success",function(){this.setState({loading:!!e.isLoading()})},this),n.on("error",function(t){this.setState({loading:!!e.isLoading(),error:t})},this)});var t=this.getModel();return t&&t.isLoading()?{loading:!0}:{}},componentDidMount:function(){var t=this.state,n=this.getModel();n&&(n.isLoading()?(this.modelOnce("async:load-complete",function(){this.setState({loading:!1})}),t.loading||this.setState({loading:!0})):t.loading&&this.setState({loading:!1}))}},"modelEventBinder")});